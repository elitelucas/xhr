webpackJsonp([29],{Cm4v:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("S9nr"),i=s("Hpey"),r=(a.a,{components:{Datetime:a.a},data:function(){return{pullUpLoad:!0,pullDownRefresh:!0,pullTxt:"松开立即加载更多",page:1,historyList:[],thisYear:Object(i.a)(new Date,"YYYY"),loadingHttp:!1,redpacketCount:[]}},created:function(){this._getRedpacketCount()},mounted:function(){},methods:{removePic:function(){this.redpacketCount.self_pic=""},removeImg:function(t){this.historyList[t].redpacket_pic=""},_getRedpacketCount:function(){var t=this;if(JSON.parse(localStorage.getItem("isUser"))){var e={token:localStorage.getItem("token"),year:this.thisYear};this.$vux.loading.show(),this.$http.post(this.urlRequest+"?m=api&c=redpacket&a=redpacketCount",e).then(function(e){t.$vux.loading.hide(),0==e.status?(t.loadingHttp=!0,t.redpacketCount=e,t.historyList=e.history_list,console.log(e)):e.ret_msg&&""!=e.ret_msg&&t.$vux.toast.show({text:e.ret_msg})}).catch(function(e){t.$vux.loading.hide(),t.$vux.toast.show({text:"Data request timed out"})})}else this.$vux.toast.show({text:"Visitors have no permission, please register as a member first"})},_getInstantlyBetting:function(t){var e=this,s={token:localStorage.getItem("token"),year:this.thisYear,page:this.page};t&&this.$vux.loading.show(),this.$http.post(this.urlRequest+"?m=api&c=redpacket&a=selfRedpacketHistory",s).then(function(s){t&&e.$vux.loading.hide(),0==s.status?(1==e.page?e.historyList=s.history_list:e.historyList=e.historyList.concat(s.history_list),s.history_list.length<10&&(e.pullUpLoadFalg=!0)):s.ret_msg&&""!=s.ret_msg&&e.$vux.toast.show({text:s.ret_msg})}).catch(function(t){e.$refs.scroll.forceUpdate(!1),e.pullUpLoad=!1,e.$vux.loading.hide(),e.$vux.toast.show({text:"Data request timed out"})})},pullingDown:function(){this.page=1,this._getInstantlyBetting(0)},pullingUp:function(){if(this.historyList){if(this.pullUpLoadFalg)return this.$refs.scroll.forceUpdate(!1),!1;this.page+=1,this._getInstantlyBetting(0)}}},watch:{thisYear:function(){this.page=1,this._getRedpacketCount(),this.pullUpLoadFalg=!1,this.$refs.scroll.scrollTo(0,0)}}}),o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"isHeader red-wrap red-record"},[a("div",{staticClass:"headerWrap"},[a("x-header",{staticClass:"header"},[t._v("红包记录")])],1),t._v(" "),t.loadingHttp?a("scroll",{ref:"scroll",attrs:{data:t.historyList,pullUpLoad:t.pullUpLoad,pullDownRefresh:t.pullDownRefresh},on:{pullingDown:t.pullingDown,pullingUp:t.pullingUp}},[a("div",[a("div",{staticClass:"record-info"},[a("datetime",{staticClass:"view-date",attrs:{"min-year":t.thisYear-2,"max-year":t.thisYear-0,format:"YYYY","year-row":"{value}年","confirm-text":"OK","cancel-text":"Cancel"},model:{value:t.thisYear,callback:function(e){t.thisYear=e},expression:"thisYear"}}),t._v(" "),a("div",{staticClass:"red-avartar"},[t.redpacketCount.self_pic?a("img",{attrs:{src:t.imgRequest+t.redpacketCount.self_pic},on:{error:t.removePic}}):a("img",{attrs:{src:s("cuiQ")}})]),t._v(" "),a("div",{staticClass:"money-info"},[a("p",[t._v("共收到")]),t._v(" "),a("h4",[t._v(t._s(t.redpacketCount.all_gain_money))])]),t._v(" "),a("div",{staticClass:"red-statist text-gray clearfix"},[a("ul",[a("li",[a("h5",[t._v(t._s(t.redpacketCount.gain_redpacket_num))]),t._v(" "),a("p",[t._v("收到红包")])]),t._v(" "),a("li",[a("h5",[t._v(t._s(t.redpacketCount.best_lucky_times))]),t._v(" "),a("p",[t._v("手气最佳")])])])])],1),t._v(" "),t.historyList.length>0?a("div",{staticClass:"red-winner"},t._l(t.historyList,function(e,i){return a("dl",{key:i},[a("router-link",{attrs:{to:{path:"/redPacket/details",query:{redpacketId:e.redpacket_id}}}},[a("dt",[e.redpacket_pic?a("img",{attrs:{src:t.imgRequest+e.redpacket_pic},on:{error:function(e){t.removeImg(i)}}}):a("img",{attrs:{src:s("cuiQ")}})]),t._v(" "),a("dd",[a("p",[t._v(t._s(e.redpacket_title))]),t._v(" "),a("p",[t._v(t._s(e.gain_date))]),t._v(" "),a("span",{staticClass:"red-money"},[t._v(t._s(e.user_gain_money))])])])],1)})):a("p",{staticClass:"noData"},[t._v("暂无数据")])])]):t._e()],1)},staticRenderFns:[]};var n=s("vSla")(r,o,!1,function(t){s("XsSx")},"data-v-d18da414",null);e.default=n.exports},XsSx:function(t,e){}});
//# sourceMappingURL=29.f7227bb7ee391e86bd5b.js.map