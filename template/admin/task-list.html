<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title></title>
    <link rel="stylesheet" href="statics/admin/css/datePicker.css">
    <!--  <link rel="stylesheet" href="statics/admin/css/pintuer.css"> -->
    <link rel="stylesheet" href="statics/admin/css/admin.css">
    <link rel="stylesheet" href="statics/admin/js/layer/2.1/skin/layer.css">
    <link rel="stylesheet" href="statics/admin/js/layer/2.1/skin/layer.ext.css">
    <script src="statics/admin/js/jquery.js"></script>
    <script src="statics/admin/js/layer/2.1/layer.js"></script>
    <script src="statics/admin/js/layer/2.1/extend/layer.ext.js"></script>
    <script src="statics/admin/js/pintuer.js"></script>

    <!-- template-begin+++ -->
    {template public-new-ui-header}
    <!-- template-end+++ -->
    <script src="statics/admin/js/jquery.date_input.pack.js"></script>
    <link rel="stylesheet" href="statics/admin/jedate/skin/jedate.css">
    <script type="text/javascript" src="statics/admin/jedate/jquery.jedate.min.js"></script>
</head>
<body style="margin: 15px;background-color: #f3f3f4;">
<div class="row">
    <div class="col-sm-12">
        <div class="ibox float-e-margins">
            <div class="ibox-title iboxWTitle">
                <h5>平台任务完成列表</h5>
            </div>
            <div class="ibox-content" style="width: 100%;">
                <div class="row">
                    <form method="post" id="form" class="form-inline">
                        <div class="col-sm-2">
                            <div class="input-group m-b"><span class="input-group-addon">会员名</span>
                                <input value="{$_REQUEST['username']}" type="text" placeholder="会员名" class="form-control" name="username" id="username">
                            </div>
                        </div>
                        <div class="col-sm-2">
                            <div class="input-group m-b"><span class="input-group-addon">任务类型</span>
                                <select name="type" class="form-control">
                                    <option value="" {if $_REQUEST['type'] == ""}selected="selected"{/if}>请选择</option>
                                    <option value="1" {if $_REQUEST['type'] == 1}selected="selected"{/if}>首次绑卡</option>
                                    <option value="2" {if $_REQUEST['type'] == 2}selected="selected"{/if}>绑定QQ</option>
                                    <option value="3" {if $_REQUEST['type'] == 3}selected="selected"{/if}>绑定微信</option>
                                    <option value="4" {if $_REQUEST['type'] == 4}selected="selected"{/if}>绑定邮箱</option>
                                    <option value="5" {if $_REQUEST['type'] == 5}selected="selected"{/if}>修改昵称</option>
                                    <option value="6" {if $_REQUEST['type'] == 6}selected="selected"{/if}>修改头像</option>
                                    <option value="7" {if $_REQUEST['type'] == 7}selected="selected"{/if}>每日签到</option>
                                    <option value="8" {if $_REQUEST['type'] == 8}selected="selected"{/if}>单次充值</option>
                                    <option value="9" {if $_REQUEST['type'] == 9}selected="selected"{/if}>累计充值</option>
                                    <option value="10" {if $_REQUEST['type'] == 10}selected="selected"{/if}>投注幸运28</option>
                                    <option value="11" {if $_REQUEST['type'] == 11}selected="selected"{/if}>投注加拿大28</option>
                                    <option value="12" {if $_REQUEST['type'] == 12}selected="selected"{/if}>投注北京PK10</option>
                                    <option value="13" {if $_REQUEST['type'] == 13}selected="selected"{/if}>投注幸运飞艇</option>
                                    <option value="14" {if $_REQUEST['type'] == 14}selected="selected"{/if}>注急速PK10</option>
                                    <option value="15" {if $_REQUEST['type'] == 15}selected="selected"{/if}>投注重庆时时彩</option>
                                    <option value="16" {if $_REQUEST['type'] == 16}selected="selected"{/if}>投注三分彩</option>
                                    <option value="17" {if $_REQUEST['type'] == 17}selected="selected"{/if}>投注香港六合彩</option>
                                    <option value="18" {if $_REQUEST['type'] == 18}selected="selected"{/if}>投注急速六合彩</option>
                                    <option value="19" {if $_REQUEST['type'] == 19}selected="selected"{/if}>投注百人牛牛</option>
                                    <option value="24" {if $_REQUEST['type'] == 19}selected="selected"{/if}>投注分分彩</option>
                                    <option value="20" {if $_REQUEST['type'] == 20}selected="selected"{/if}>任务达成数3</option>
                                    <option value="21" {if $_REQUEST['type'] == 21}selected="selected"{/if}>任务达成数7</option>
                                    <option value="22" {if $_REQUEST['type'] == 22}selected="selected"{/if}>任务达成数13</option>
                                    <option value="23" {if $_REQUEST['type'] == 23}selected="selected"{/if}>连续签到7次</option>
                                </select>
                            </div>
                        </div>

                        <div class="col-sm-2">
                            <div class="input-group m-b"><span class="input-group-addon">领取状态</span>
                                <select name="state" class="form-control">
                                    <option value="" {if $_REQUEST['state'] == ""}selected="selected"{/if}>请选择</option>
                                    <option value="1" {if $_REQUEST['state'] == 1}selected="selected"{/if}>未领取</option>
                                    <option value="2" {if $_REQUEST['state'] == 2}selected="selected"{/if}>已领取</option>
                                    <option value="3" {if $_REQUEST['state'] == 3}selected="selected"{/if}>已失效</option>
                                </select>
                            </div>
                        </div>

                        <div class="col-sm-3">
                            <div class="input-group m-b">
                                <span class="input-group-addon">完成时间</span>
                                <input style="width: 48%" type="text" name="complete_start_time" placeholder="开始时间" class="date_picker form-control" value="{$_REQUEST['complete_start_time']}" />
                                <span style="float: left">&nbsp;&nbsp;</span>
                                <input style="width: 48%" type="text" name="complete_end_time" placeholder="结束时间" class="date_picker form-control" value="{$_REQUEST['complete_end_time']}" />
                            </div>
                        </div>
                        <br />
                        <br />
                        <br />
                        <div class="col-sm-3">
                            <div class="input-group m-b">
                                <span class="input-group-addon">领取时间</span>
                                <input style="width: 48%" type="text" name="receive_start_time" placeholder="开始时间" class="date_picker form-control" value="{$_REQUEST['receive_start_time']}" />
                                <span style="float: left">&nbsp;&nbsp;</span>
                                <input style="width: 48%" type="text" name="receive_end_time" placeholder="结束时间" class="date_picker form-control" value="{$_REQUEST['receive_end_time']}" />
                            </div>
                        </div>


                        <div class="col-sm-2">
                            <div class="input-group m-b">
                                <button type="submit" class="btn btn-primary">搜索</button>
                                &nbsp;
                                <button type="button" class="btn btn-primary" onclick="javascript:location.href = '?m=admin&c=activity&a=taskList'">重置</button>
                            </div>
                        </div>
                    </form>
                </div>
                <div id="editable_wrapper" class="dataTables_wrapper form-inline" role="grid" style="width: 100%">
                    <table class="table table-striped table-bordered table-hover  dataTable" id="editable" aria-describedby="editable_info">
                        <thead>
                        <tr>
                            <th>序号</th>
                            <th>会员帐号</th>
                            <th>任务类型</th>
                            <th>领取状态</th>
                            <th>领取金额</th>
                            <th>完成时间</th>
                            <th>失效时间</th>
                            <th>领取时间</th>
                            <th>备注</th>
                        </tr>
                        </thead>
                        <tbody id="list_tb">
                        {if empty($data)}
                        <tr>
                            <td colspan="9" align="center"> 暂无信息 </td>
                        </tr>
                        {else}
                        {loop $data $val}
                        <tr>
                            <td>{$val['id']}</td>
                            <td>{$val['username']}</td>
                            <td>{$val['name']}</td>
                            <td>{if $val['state'] == 1}<span style="color: green">未领取</span>{elseif $val['state'] == 2}<span style="color: #0d8ddb">已领取</span>{else}<span style="color: red">已失效</span>{/if}</td>
                            <td>{$val['money']}</td>
                            <td><?php echo date("Y-m-d H:i:s",$val['complete_time'])   ?></td>
                            <td><?php echo $val['invalid_time'] == 0 ? "----" : date("Y-m-d H:i:s",$val['invalid_time']); ?></td>
                            <td><?php echo $val['receive_time'] == 0 ? "----" : date("Y-m-d H:i:s",$val['receive_time']); ?></td>
                            <td>{$val['remark']}</td>
                        </tr>
                        {/loop}
                        {/if}

                        </tbody>
                    </table>
                </div>
                <div class="row">
                    <div class="col-sm-7">
                        <div class="dataTables_info" id="editable_info" role="alert" aria-live="polite" aria-relevant="all">
                            <span class="back-page">总计已领取金额</span>
                            {$total['receive_money']}
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <span class="back-page">总计未领取金额</span>
                            {$total['complete_money']}
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <span class="back-page">总计已失效金额</span>
                            {$total['invalid_money']}
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <span class="back-page">当前页已领取金额</span>
                            {$pageTotal['receive_total']}
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <span class="back-page">当前页未领取金额</span>
                            {$pageTotal['complete_total']}
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <span class="back-page">当前页已失效金额</span>
                            {$pageTotal['invalid_time_total']}
                        </div>
                    </div>
                    <div class="col-sm-5">
                        <?php echo $show;?>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    var loading = '';
    //时间插件
    $(".date_picker").jeDate({
        //isinitVal:true,
        ishmsVal:true,
        format:"YYYY-MM-DD",
        zIndex:3000,
    });

    $("#form").submit(function(){
        var complete_start_time = $("[name='complete_start_time']").val();
        var complete_end_time = $("[name='complete_end_time']").val();
        var receive_start_time = $("[name='receive_start_time']").val();
        var receive_end_time = $("[name='receive_end_time']").val();
        if ((complete_start_time != "" && complete_end_time != "" && complete_start_time > complete_end_time) ||  (receive_start_time != "" && receive_end_time != "" && receive_start_time > receive_end_time)) {
            layer.msg('起始时间不能大于结束时间', {icon: 5, shade: [0.5, '#393D49']});
            return false;
        }
    })
</script>
</body>
</html>