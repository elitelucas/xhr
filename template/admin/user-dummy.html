<!DOCTYPE html>

<html lang="zh-cn">

<head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>

    <link rel="stylesheet" href="statics/admin/css/pintuer.css">

    <link rel="stylesheet" href="statics/admin/css/admin.css">

    <link rel="stylesheet" href="statics/admin/js/layer/2.1/skin/layer.css">

    <link rel="stylesheet" href="statics/admin/js/layer/2.1/skin/layer.ext.css">



    <!-- <script src="statics/admin/js/jquery.min.js" type="text/javascript"></script> -->

    <script src="statics/admin/js/jquery.js"></script>

    <script src="statics/admin/js/layer/2.1/layer.js"></script>

    <script src="statics/admin/js/layer/2.1/extend/layer.ext.js"></script>

    <!-- Validform -->

    <link rel="stylesheet" href="/statics/web/extend/Validform_v5.3.2/css/style.css" type="text/css" media="all" />

    <script type="text/javascript" src="/statics/web/extend/Validform_v5.3.2/js/Validform_v5.3.2_min.js"></script>

    <!-- Validform - end -->

    <!-- 密码强度-->

    <link rel="stylesheet" href="/statics/web/extend/Validform_v5.3.2/plugin/passwordStrength/passwordStrength.css" type="text/css" media="all" />

    <script type="text/javascript" src="/statics/web/extend/Validform_v5.3.2/plugin/passwordStrength/passwordStrength-min.js"></script>

    <!-- 密码强度 - end -->

    <script src="statics/admin/js/pintuer.js"></script>

	

    <script src="statics/admin/bootstrap/js/bootstrap.min.js"></script>

    {template public-new-ui-header}

    <script src="statics/admin/fileupload/js/vendor/jquery.ui.widget.js"></script>

    <script src="statics/admin/fileupload/js/jquery.fileupload.js"></script>

</head>

<body class="new_ui_body">

    <div class="row">

        <div class="col-sm-12">

            <div class="ibox float-e-margins">



                <div class="ibox-title iboxWTitle">

                    <h5>添加假人</h5>

                    <div class="ibox-tools">

                        <a href="javascript:;" class="btn btn-white btn-bitbucket" onclick="history.go(-1);">

                            <i class="fa fa-reply"></i>返回

                        </a>

                    </div>

                </div>

                <div class="ibox-content bagCol" style="width: 100%;">



                    <form method="post" class="form-x Validform" action="" id="form">

                        <div class="ibox-title">

                            <h5>假人信息</h5>

                        </div>

                        <div class="ibox-content m-b" style="width: 100%;">

                            <div class="row">

                                <div class="form-group">

                                    <label class="col-sm-2 control-label input_title"><i class="red_star">*</i>账号</label>

                                    <div class="col-sm-10">

                                        <input class="form-control pull-left ip-tips-box" placeholder="请输入您的账号" type="text" name="username" id="user" datatype="/^[a-zA-Z0-9]{6,15}$/" ajaxurl="<?=url('','user','selectName')?>" sucmsg="用户名验证通过！" nullmsg="请输入您的账号！" errormsg="账号由字母和数字组成,范围在6~15位之间！"/>

                                        <div class="tips Validform_checktip pull-left div-tips-box"></div>

                                    </div>

                                </div>



                                <div class="form-group">

                                    <label class="col-sm-2 control-label input_title"><i class="red_star">*</i>密码</label>

                                    <div class="col-sm-10">

                                        <input class="form-control pull-left ip-tips-box" placeholder="请输入您的密码" type="password" name="password" id="pas" plugin="passwordStrength" datatype="/^[a-zA-Z0-9_]{6,15}$/" nullmsg="请输入您的密码！" errormsg="密码由字母和数字以及下划线组成,范围在6~15位之间！" />

                                        <div class="tips Validform_checktip pull-left div-tips-box"></div>

                                        <p class="passwordStrength pull-left" style="display:none;width:100%;"><b>密码强度：</b> <span>弱</span><span>中</span><span class="last">强</span></p>

                                    </div>

                                </div>



                                <div class="form-group">

                                    <label class="col-sm-2 control-label input_title"><i class="red_star">*</i>确认密码</label>

                                    <div class="col-sm-10">

                                        <input class="form-control pull-left ip-tips-box" placeholder="请再次输入您的密码" type="password" name="password2" id="pas1" datatype="*" recheck="password"  nullmsg="请再次输入您的密码！" errormsg="两次密码输入不一致！" />

                                        <div class="tips Validform_checktip pull-left div-tips-box"></div>

                                    </div>

                                </div>

								

								<div class="form-group">

                                    <label class="col-sm-2 control-label input_title"><i class="red_star">*</i>呢称</label>

                                    <div class="col-sm-10">

                                        <input class="form-control pull-left ip-tips-box" placeholder="请输入您的呢称" type="text" name="nickname" id="nickname"/>

                                        <div class="tips Validform_checktip pull-left div-tips-box"></div>

                                    </div>

                                </div>

								

								

								<div class="form-group">

                                    <label class="col-sm-2 control-label input_title"><i class="red_star">*</i>等级</label>

                                    <div class="col-sm-10">

										<select name="honor_upgrade" class="form-control pull-left ip-tips-box" id="honor_upgrade">

											<?php foreach($honor_info as $honor):?>

												<option value="<?php echo $honor['sort'];?>"><?php echo $honor['name'];?></option>

											<?php endforeach;?>

										</select>

                                        <div class="tips Validform_checktip pull-left div-tips-box"></div>

                                    </div>

                                </div>



								 <div class="form-group">

									<label class="col-sm-2 control-label input_title">头像</label>

									<div class="col-sm-4">

										<img class="avatar-img" src="{$list['avatar']}" alt="" style="float: left;width:200px; {if $list['avatar'] == ''} display:none; {/if}" onclick="this.nextElementSibling.click();">

										<input style="display:none;" name="file" class="file_upload avatar-input" type="file">

										{if $list['avatar'] == ""}

										<a class="avatar-a" href="javascript:;" onclick="this.previousElementSibling.click();">上传图片<br />(建议图片大小210*210)</a>

										{/if}

										<input class="form-control" name="avatar" value="{$list['avatar']}" type="hidden">

									</div>



									<div class="col-sm-2"><button id="fromSys" class="btn btn-primary" type="button">使用系统头像</button></div>

								</div>

								<hr>


                                <div class="form-group">

                                    <div class="col-sm-10 col-sm-offset-2">

                                        <button class="btn btn-primary" type="submit" id="btn_submit">提交</button>

                                        &nbsp;

                                        <button class="btn btn-white" type="button" onclick="history.go(-1);">取消</button>

                                    </div>

                                </div>



                            </div>

                        </div>
                        

                    </form>
                    
                </div>

            </div>



        </div>

    </div>

<script type="text/javascript">

	var close;

	$('#fromSys').click(function () {

		close = layer.open({

			type: 2,

			title: "选择系统头像",

			content: "<?=url('','role','sysImg')?>",

			end:function () {

			}

		});

		layer.full(close);

	});

	

	

	$(".file_upload").fileupload({

		url: "?m=admin&c=role&a=uploadFile",

		sequentialUploads: true

	}).bind('fileuploaddone', function(e, data) {

		var res = $.parseJSON(data.result);

		if (res.code == 0) {

			$(".avatar-img").attr({'src': res.msg}).show();

			$(".avatar-input").attr({'style': "width:200px; float: left; opacity: 0 ; margin-left: -200px"});



			$('input[name="avatar"]').val(res.msg);

			$('.avatar-a').css("display","none");

		} else {

			layer.msg(res.msg,{icon:5, shade: [0.5, '#393D49']}); //弹出错误信息

			return false;

		}

	});



    $(function(){

        $(".Validform").Validform({

            url:"<?=url('','user','setDummy')?>",

            usePlugin:{

                passwordstrength:{

                    minLen:6,//设置密码长度最小值，默认为0;

                    maxLen:16,//设置密码长度最大值，默认为30;

                    trigger:function(obj,error){

                        //该表单元素的keyup和blur事件会触发该函数的执行;

                        //obj:当前表单元素jquery对象;

                        //error:所设密码是否符合验证要求，验证不能通过error为true，验证通过则为false;



                        //console.log(error);

                        if(error){

                            obj.siblings(".passwordStrength").hide();

                        }else{

                            obj.siblings(".passwordStrength").show();

                        }

                    }

                }

            },

            tiptype:function(msg,o,cssctl){

                //msg：提示信息;

                //o:{obj:*,type:*,curform:*}, obj指向的是当前验证的表单元素（或表单对象），type指示提示的状态，值为1、2、3、4， 1：正在检测/提交数据，2：通过验证，3：验证失败，4：提示ignore状态, curform为当前form对象;

                //cssctl:内置的提示信息样式控制函数，该函数需传入两个参数：显示提示信息的对象 和 当前提示的状态（既形参o中的type）;



                if(!o.obj.is("form")){  //验证表单元素时o.obj为该表单元素，全部验证通过提交表单时o.obj为该表单对象;

                    var objtip=o.obj.siblings(".Validform_checktip");

                    if(o.type!=2){

                        cssctl(objtip,o.type);

                        objtip.text(msg).show();

                    }else {

                        cssctl(objtip,0);

                        objtip.text('').hide();

                    }

                }

            },

            ajaxPost:true,

            callback:function(data){

                if(data.status==0){

                    layer.msg(data.info, {icon: 6, shade: [0.5, '#393D49']}, function () {

                        location.reload();

                    });

                }else {

                    layer.open({

                        content: "<p class='alert_msg'>"+data.info+"</p>",

                        btn: '<p class="alert_buttom">我知道了</p>'

                    });

                    //$.Showmsg(data.ret_msg);

                }

            }

        });

    })

</script>

</body>

</html>