<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta content="target-densitydpi=320,width=750,user-scalable=no" name="viewport" />
    <meta content="no" name="apple-touch-fullscreen" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />

    <title>钱包</title>
    <!--<link href="/statics/web/css/css.css" rel="stylesheet" type="text/css">-->
    <!--<script src="/statics/web/js/jquery.1.8.2.min.js"></script>-->
    <!--<script src="/statics/web/js/style.js"></script>-->
    {template public-header}
    <script src="/statics/web/extend/layer/mobile/layer.js"></script>
</head>
<body>
<header>
    <em onclick="history.go(-1)">返回</em>
    <h1>{$payTypeName}线上充值</h1>
</header>
<section>
    <div class="modify bgFF">

        <div class="wallet">
            <div class="onLineGirl"><i><img src="{$avatar}" /></i> </div>
            <div class="onLineGirl4"><em class="icoGirl4">会员账号：{$nickname}</em></div>
        </div>



        <ul class="onLinePad">

            <li>

                <label class="icoMoney" for="money">充值金额：<input type="number" id="money">

                </label>
                <p style="position: absolute;top: 76px;left: 53px; color: #ccc">(人民币)</p>
<!--                <p class="remarks"><span class="red">*</span>范围：100-500000<br>
                    建议通过银行卡转账入款</p>-->

            </li>
        </ul>
<!--        <div class="bankCard2 chongzhi">
            <dl>

                <dd>
                    <h3>支付方式</h3>
                    <ul class="radioClass">
                        
                        <li><input id="radio2" name="radio" value="1" type="radio" {if $type == 1}checked{/if}/><label for="radio2" class="icoWeix2">微信</label></li>
                        <li><input id="radio1" name="radio" value="2" type="radio" {if $type == 2}checked{/if} /><label for="radio1" class="icoZfb2">支付宝</label></li>    
                    </ul>
            </dl> 
        </div>-->
        <div class="weixintishi">
            <h4>温馨提示：</h4>
            <?php if($paymentInfoArr['type'] == "67") { ?>
                <!--微信-->
                <p>微信支付：扫一扫直接到账，方便快捷，支付完成立即到账。</p>
            <?php }else if($paymentInfoArr['type'] == "68") { ?>
                <!--支付宝-->
                <p>支付宝支付：使用支付宝扫一扫支付，方便快捷，支付完成立即到账。</p>
            <?php }else if($paymentInfoArr['type'] == "139") { ?>
                <!--QQ钱包-->
                <p>QQ钱包支付：使用QQ账号扫一扫支付，方便快捷，支付完成立即到账。</p>
           	<?php }elseif($paymentInfoArr['type'] == "mbzf") { ?>
                <p>1.点击“立即支付”系统将会生成对应您充值金额的二维码。</p>
                <p>2.您可以截图当前屏幕，也可以用其他手机扫描支付。</p>
                <p>3.请在微信中打开“扫一扫”</p>
                <p>4.在扫一扫中点击右上角“相册”，从相册中选择刚才保存的屏幕截图。</p>
                <p>5.在微信中完成支付后，等待账户到账。如充值未及时到账，请联系在线客服。</p>
            <?php }elseif($paymentInfoArr['nid'] == "mbzf" && $paymentInfoArr['type'] == 68){ ?>
                <!--魔宝 支付宝-->
                <p>1.点击“立即支付”系统将会生成对应您充值金额的二维码。</p>
                <p>2.您可以截图当前屏幕，也可以用其他手机扫描支付。</p>
                <p>3.请在支付宝中打开“扫一扫”</p>
                <p>4.在扫一扫中点击右上角“相册”，从相册中选择刚才保存的屏幕截图。</p>
                <p>5.在支付宝中完成支付后，等待账户到账。如充值未及时到账，请联系在线客服。</p>
            <?php }elseif($paymentInfoArr['nid'] == "mbzf" && $paymentInfoArr['type'] == 75){ ?>
                <!--魔宝 网银-->
                <p>1.首先需要您有已开通的网上银行账户。</p>
                <p>2.请确保您记得您的网上银行账户卡号。</p>
                <p>3.选择对应的网上银行进行支付。</p>
                <p>4.充值完成之后，等到账户到账。</p>
                <p>5.如充值未及时到账，请联系在线客服。</p>
                <p>6.充值会有延迟，请耐心等待片刻。</p>
            <?php }elseif($paymentInfoArr['ybzf'] == "mbzf" && $paymentInfoArr['type'] == 75){ ?>
                <!--易宝 网银-->
                <p>1.首先需要您有已开通的网上银行账户。</p>
                <p>2.请确保您记得您的网上银行账户卡号。</p>
                <p>3.选择对应的网上银行进行支付。</p>
                <p>4.充值完成之后，等到账户到账。</p>
                <p>5.如充值未及时到账，请联系在线客服。</p>
                <p>6.充值会有延迟，请耐心等待片刻。</p>
            <?php }elseif($paymentInfoArr['sfzf'] == "mbzf" && $paymentInfoArr['type'] == 75){ ?>
                <!--闪付 网银-->
                <p>1.闪付支持微信、支付宝、网银支付。</p>
                <p>2.选择您需要的支付方式进行充值。</p>
                <p>3.微信和支付宝会生成对应您充值金额的二维码，您可以通过截图保存二维码至相册。</p>
                <p>4.打开微信或支付宝的“扫一扫”，识别相册中的二维码，进行充值。</p>
                <p>5.网银支付您需要有对应已开通网上银行的账户。</p>
                <p>6.通过填写网上银行账户及密码进行支付。</p>
                <p>7.充值完成之后，等待账户到账。</p>
                <p>8.如充值未及时到账，请联系在线客服。</p>
            <?php } ?>

        </div>
        <div class="button" style="margin-top: 50px"><button class="bgCol" id="xsBtn">立即支付</button></div>
        <div style="height: 70px;"></div>
    </div>
<div id="jumpHtml">
</div>
</section>
    <script type="text/javascript">
        var url = "<?=url('','','dopay')?>";
        var lower_limit = "{$Config['value']}";
        var payment_id = "{$payment_id}";
        var type_mode = "{$configArr['type']}";
        //var host = window.location.host;
        var nid = "{$paymentInfoArr['nid']}";

        $(function() {
            $("#xsBtn").click(function() {
                var money = $("#money").val();
                
                //金额判断
                if (money == '') {
                    layer.open({
                        content: "<p class='alert_msg'>请输入充值金额</p>",
                        btn: '我知道了'
                    });
                    return;
                }

                //判断金额是否正确
                if (parseInt(money) < parseInt(lower_limit)) {
                    layer.open({
                        content: "<p class='alert_msg'>输入的金额不能小于"+lower_limit+"元</p>",
                        btn: '我知道了'
                    })
                    return;
                }

               $.ajax({
                   url: url,
                   type: 'post',
                   data: {payment_id: payment_id, money: money},
                   typeData: 'json',
                   success: function(data) {
                       data = $.parseJSON(data);
                       console.log(data);
                       if (data.status == 0) { //成功
                    	   if (data.type == 1) {
                           		window.location.href = "<?=url('','pay','rechargeQrcode')?>&money=" + money + '&order_no=' + data.order_no + '&payment_id=' + payment_id;
                       
                    	   }else if (data.type == 2) {
                    		   document.write(data.html);
                    		   $('#payFrom').submit();
                    	   }
                   	   } else {
                          $(".bgCol").removeAttr("disabled");
                          layer.open({
                              content: "<p class='alert_msg'>"+ data.ret_msg +"</p>",
                              btn: '我知道了'
                          });
                       }
                   },
                   error: function(error) {
                       $(".bgCol").removeAttr("disabled");
                       layer.open({
                           content: "<p class='alert_msg'>服务器出错了</p>",
                           btn: '我知道了'
                       });
                   }
               });
                
            });
        });
    </script>

</body>
</html>